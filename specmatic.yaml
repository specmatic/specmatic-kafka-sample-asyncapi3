version: 3
systemUnderTest:
  service:
    $ref: "#/components/services/orderAsyncService"
    runOptions:
      $ref: "#/components/runOptions/orderAsyncServiceTest"
    data:
      examples:
        - directories:
            - "${EX_DIR:examples}"

dependencies:
  services:
    - service:
        $ref: "#/components/services/orderStatusService"
        runOptions:
          $ref: "#/components/runOptions/orderStatusServiceMock"
        data:
          examples:
            - directories:
                - "${EX_DIR:examples}"

components:
  sources:
    specmaticOrderContracts:
      filesystem:
        directory: .
  services:
    orderAsyncService:
      definitions:
        - definition:
            source:
              $ref: "#/components/sources/specmaticOrderContracts"
            specs:
              - specs/async-order-service.yaml
    orderStatusService:
      definitions:
        - definition:
            source:
              $ref: "#/components/sources/specmaticOrderContracts"
            specs:
              - specs/order-status-service.yaml
  runOptions:
    orderAsyncServiceTest:
      asyncapi:
        type: test
        servers:
          - host: "localhost:9092"
            protocol: kafka
    orderStatusServiceMock:
      openapi:
        type: mock
        baseUrl: "http://0.0.0.0:8080"
